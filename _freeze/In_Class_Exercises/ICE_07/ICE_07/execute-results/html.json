{
  "hash": "5c5efa890445891a59e5a68eafeb34f5",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"In Class Exercise 07: Visualising, Analysing and Forecasting Time-series Data with tidyverts methods\"\nauthor: \"Yee Jun Yit\"\ndate-modified: \"last-modified\"\nexecute:\n  echo: true\n  eval: true\n  warning: false\n  freeze: true\neditor: visual\n---\n\n\n\n## Overview\n\n[tidyverts](https://tidyverts.org/) is family of R packages specially designed for visualising, analysing and forecasting time-series data conforming to tidyverse framework. Created by [Dr. Rob Hyndman](https://robjhyndman.com/) from Monash University, it is intended to be the replacement for the extant [**forecast**](https://pkg.robjhyndman.com/forecast/) package.\n\nAn online companion textbook [Forecasting: Principles and Practice, 3rd Edition](https://otexts.com/fpp3/)(Hyndman and Athanasopoulos) is provided.\n\nIn this exercise, we will:\n\n-   import and wrangle with time-series data by using appropriate tidyverse methods,\n-   visualise and analyse time-series data,\n-   calibrate time-series forecasting models by using exponential smoothing and ARIMA techniques, and\n-   compare and evaluate the performance of forecasting models.\n\n## Loading Data\n\nWe will be using the following packages:\n\n-   [**lubridate**](https://lubridate.tidyverse.org/), part of **tidyverse**, provides a collection to functions to parse and wrangle time and date data;\n-   tidyverse, a family of R packages for data science processes;\n-   [**tsibble**](https://tsibble.tidyverts.org/) provides a data infrastructure for tidy temporal data with wrangling tools. Adapting the tidy data principles, tsibble is a data- and model-oriented object;\n-   [**feasts**](https://feasts.tidyverts.org/) provides a collection of tools for the analysis of time series data. The package name is an acronym comprising of its key features: Feature Extraction And Statistics for Time Series;\n-   [**fable**](https://fable.tidyverts.org/) provides a collection of commonly used univariate and multivariate time series forecasting models including exponential smoothing via state space models and automatic ARIMA modelling\n\nThe latter three packages belong to [**tidyverts**](https://tidyverts.org/), a family of tidy tools for time series data handling, analysis and forecasting.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(lubridate, tidyverse, tsibble, feasts, fable, seasonal)\n```\n:::\n\n\n\nWe will be using *visitor_arrivals_by_air.csv*, which is a cleaned dataset consisting of monthly data where each column is a country containing the number of arrivals from that country in that particular month.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nts_data <- read_csv(\n  \"data/visitor_arrivals_by_air.csv\")\n```\n:::\n\n\n\n### Preprocessing\n\nWe see that the *Month-Year* is a Character field, which is not convenient when analysing time-series data. We use `dmy()` of **lubridate** package is used to convert data type of Month-Year field from Character to Date.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nts_data$`Month-Year` <- dmy(\n  ts_data$`Month-Year`)\n```\n:::\n\n\n\nWe can also see that ts_data is a tibble data.frame.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nclass(ts_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"spec_tbl_df\" \"tbl_df\"      \"tbl\"         \"data.frame\" \n```\n\n\n:::\n:::\n\n\n\nWe could convert the data.frame into a base R time series object.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nts_data_ts <- ts(ts_data)       \nclass(ts_data_ts)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"mts\"    \"ts\"     \"matrix\" \"array\" \n```\n\n\n:::\n:::\n\n\n\nHowever, built on top of the tibble, a *tsibble* (or tbl_ts) is a data- and model-oriented object. Compared to the conventional time series objects in R, e.g. ts, zoo, xts, a tsibble preserves time indices as the essential data column and makes heterogeneous data structures possible. Beyond the tibble-like representation, keys comprised of single or multiple variables is introduced to uniquely identify observational units over time (index).\n\nAs a tsibble object is more convenient for dealing with time-series data, so we convert it using the `as_tsibble()` function from the **tsibble** package.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nts_tsibble <- ts_data %>%\n  mutate(Month = yearmonth(`Month-Year`)) %>%\n  as_tsibble(index = `Month`)\nts_tsibble\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tsibble: 144 x 35 [1M]\n   `Month-Year` `Republic of South Africa` Canada   USA Bangladesh Brunei China\n   <date>                            <dbl>  <dbl> <dbl>      <dbl>  <dbl> <dbl>\n 1 2008-01-01                         3680   6972 31155       6786   3729 79599\n 2 2008-02-01                         1662   6056 27738       6314   3070 82074\n 3 2008-03-01                         3394   6220 31349       7502   4805 72546\n 4 2008-04-01                         3337   4764 26376       7333   3096 76112\n 5 2008-05-01                         2089   4460 26788       7988   3586 64808\n 6 2008-06-01                         2515   3888 29725       8301   5284 55238\n 7 2008-07-01                         2919   5313 33183       9004   4070 80747\n 8 2008-08-01                         2471   4519 27427       7913   4183 66625\n 9 2008-09-01                         2492   3421 21588       7549   3160 52649\n10 2008-10-01                         3023   4756 25112       7527   2983 54423\n# ℹ 134 more rows\n# ℹ 28 more variables: `Hong Kong SAR (China)` <dbl>, India <dbl>,\n#   Indonesia <dbl>, Japan <dbl>, `South Korea` <dbl>, Kuwait <dbl>,\n#   Malaysia <dbl>, Myanmar <dbl>, Pakistan <dbl>, Philippines <dbl>,\n#   `Saudi Arabia` <dbl>, `Sri Lanka` <dbl>, Taiwan <dbl>, Thailand <dbl>,\n#   `United Arab Emirates` <dbl>, Vietnam <dbl>, `Belgium & Luxembourg` <dbl>,\n#   Finland <dbl>, France <dbl>, Germany <dbl>, Italy <dbl>, …\n```\n\n\n:::\n:::\n\n\n\n::: {callout-note}\n#### What we can learn from the code chunk above\n\n-   `mutate()` of **dplyr** package is used to derive a new field by transforming the data values in Month-Year field into month-year format.\n-   The transformation is performed by using [yearmonth()](https://tsibble.tidyverts.org/reference/year-month.html) of **tsibble** package. - [as_tsibble()](https://tsibble.tidyverts.org/reference/as-tibble.html) is used to convert the tibble data.frame into a tsibble.\n:::\n\n## Visualising the Time-series Data\n\nIn order to visualise the time-series data effectively, we need to organise the data frame from wide to long format by using [pivot_longer()](https://tidyr.tidyverse.org/reference/pivot_longer.html) of **tidyr** package as shown below.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nts_longer <- ts_data %>%\n  pivot_longer(cols = c(2:34),\n               names_to = \"Country\",\n               values_to = \"Arrivals\")\n```\n:::\n\n\n\n### Visualising single time-series: ggplot2 methods\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nts_longer %>%\n  filter(Country == \"Vietnam\") %>%\n  ggplot(aes(x = `Month-Year`, \n             y = Arrivals))+\n  geom_line(size = 0.5)\n```\n\n::: {.cell-output-display}\n![](ICE_07_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\n::: {callout-note}\n#### What we can learn from the code chunk above\n\n-   [filter()](https://dplyr.tidyverse.org/reference/filter.html) of [**dplyr**](https://dplyr.tidyverse.org/) package is used to select records belong to Vietnam.\n-   [geom_line()](https://ggplot2.tidyverse.org/reference/geom_path.html) of [**ggplot2**](https://ggplot2.tidyverse.org/) package is used to plot the time-series line graph.\n:::\n\n### Plotting multiple time-series data with ggplot2 methods\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = ts_longer, \n       aes(x = `Month-Year`, \n           y = Arrivals,\n           color = Country))+\n  geom_line(size = 0.5) +\n  theme(legend.position = \"bottom\", \n        legend.box.spacing = unit(0.5, \"cm\"))\n```\n\n::: {.cell-output-display}\n![](ICE_07_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n\nWe can see having multiple countries' data in the same plot as above is very messy and difficult to distinguish. In order to provide an effective comparison, [facet_wrap()](https://ggplot2.tidyverse.org/reference/facet_wrap.html) of **ggplot2** package is used instead to create small multiple line graphs a.k.a. trellis plot.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = ts_longer, \n       aes(x = `Month-Year`, \n           y = Arrivals))+\n  geom_line(size = 0.5) +\n  facet_wrap(~ Country,\n             ncol = 3,\n             scales = \"free_y\") +\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![](ICE_07_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n\n::: {callout-note}\n#### What we can learn from the code chunk above\n\n-   `scales=\"free_y\"` argument allows the y-axis values of each countries' subplot to be independent of each other to be able to see the absolute values clearly, instead of viewing relative graphs on a fixed axis value.\n:::\n\n## Visual Analysis of Seasonality in Time-series Data\n\nTime series data can contain a seasonal component, which is a cycle that repeats over time, such as monthly or yearly. This repeating cycle is something that we wish to incorporate into the model when fitting it, and provides a strong signal to our predictive forecasts.\n\nAs above, we organise the tsibble into a long format from wide format.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntsibble_longer <- ts_tsibble %>%\n  pivot_longer(cols = c(2:34),\n               names_to = \"Country\",\n               values_to = \"Arrivals\")\n```\n:::\n\n\n\n### Visual Analysis of Seasonality with Seasonal Plot\n\nA seasonal plot is similar to a time plot except that the data are plotted against the individual seasons in which the data were observed, split by year.\n\nWe use [gg_season()](https://feasts.tidyverts.org/reference/gg_season.html) of **feasts** package.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntsibble_longer %>%\n  filter(Country == \"Italy\" |\n         Country == \"Vietnam\" |\n         Country == \"United Kingdom\" |\n         Country == \"Germany\") %>% \n  gg_season(Arrivals)\n```\n\n::: {.cell-output-display}\n![](ICE_07_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n\n### Visual Analysis of Seasonality with Cycle Plot\n\nA cycle plot shows how a trend or cycle changes over time, and we can use them to see seasonal patterns. Typically, a cycle plot shows a measure on the Y-axis and then shows a time period (such as months or seasons) along the X-axis. For each time period, there is a trend line across a number of years.\n\nHere, we plot two time-series lines of visitor arrivals from Vietnam and Italy. Both lines reveal clear signs of seasonal patterns but not the trend.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntsibble_longer %>%\n  filter(Country == \"Vietnam\" |\n         Country == \"Italy\") %>% \n  autoplot(Arrivals) + \n  facet_grid(Country ~ ., scales = \"free_y\")\n```\n\n::: {.cell-output-display}\n![](ICE_07_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n\nNow, we can plot cycle plots using [gg_subseries()](https://feasts.tidyverts.org/reference/gg_subseries.html) of **feasts** package. The cycle plots show not only seasonal patterns but also the trend.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntsibble_longer %>%\n  filter(Country == \"Vietnam\" |\n         Country == \"Italy\") %>% \n  gg_subseries(Arrivals)\n```\n\n::: {.cell-output-display}\n![](ICE_07_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n\n::: {callout-note}\n#### What we can learn from the code chunk above\n\n-   `gg_subseries\" provides a simple function to plot a cycle plot, as opposed to having to manually do the plot combining`geom_line()`,`geom_hline()`in a`facet_grid()\\`.\n:::\n\nWe can see the data paints a more detailed picture of seasonality: Italians will suddenly surge in numbers of arrivals in the month of August, while the Vietnamese have more obvious shoulder season with a gradual progression towards their peak in July before coming back down.\n\n## Time-series Decomposition\n\nTime series decomposition allows us to isolate structural components from models such as ARIMA. the autoregressive (AR), integrative (I), and moving average (MA) components with seasonality can be extracted from the time-series data.\n\n### Single time series decomposition\n\nIn **feasts** package, time series decomposition is supported by the functions [ACF()](https://feasts.tidyverts.org/reference/ACF.html), [PACF()](https://feasts.tidyverts.org/reference/ACF.html), [CCF()](https://rdrr.io/r/stats/acf.html), [feat_acf()](https://feasts.tidyverts.org/reference/feat_acf.html), and [feat_pacf()](https://feasts.tidyverts.org/reference/feat_acf.html).\n\nThe output can then be plotted by using `autoplot()` of **feasts** package.\n\nHere, we plot the auto-correlation function of visitor arrivals from Vietnam.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntsibble_longer %>%\n  filter(`Country` == \"Vietnam\") %>%\n  ACF(Arrivals) %>% \n  autoplot()\n```\n\n::: {.cell-output-display}\n![](ICE_07_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n\nHere, we plot the partial auto-correlation function of visitor arrivals from Vietnam. It differs from the ACF in that it only accounts for correlation of time t with time t-k without considering indirect infuences from between those two time periods.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntsibble_longer %>%\n  filter(`Country` == \"Vietnam\") %>%\n  PACF(Arrivals) %>% \n  autoplot()\n```\n\n::: {.cell-output-display}\n![](ICE_07_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\n\n### Multiple time-series decomposition\n\nWe build a trellis plot of ACFs for visitor arrivals from Vietnam, Italy, United Kingdom and China.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntsibble_longer %>%\n  filter(`Country` == \"Vietnam\" |\n         `Country` == \"Italy\" |\n         `Country` == \"United Kingdom\" |\n         `Country` == \"China\") %>%\n  ACF(Arrivals) %>%\n  autoplot()\n```\n\n::: {.cell-output-display}\n![](ICE_07_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\n\nWe can clearly see that:\n\n-   Italy arrivals have a clear seasonality with a 12 month lag\n-   China arrivals show a clear seasonality with 6 month lags, with a positive trend as the ACF is always significant\n-   Vietnam arrivals show a clear seasonality with 12 month lags, with a positive trend as the ACF is always significant\n\nWe now build a trellis plot of PACFs for visitor arrivals from Vietnam, Italy, United Kingdom and China.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntsibble_longer %>%\n  filter(`Country` == \"Vietnam\" |\n         `Country` == \"Italy\" |\n         `Country` == \"United Kingdom\" |\n         `Country` == \"China\") %>%\n  PACF(Arrivals) %>%\n  autoplot()\n```\n\n::: {.cell-output-display}\n![](ICE_07_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n\n\nWe note that the PACF for UK and Vietnam arrivals are negative for lag t-2 which are significant. This indicates that the number of arrivals two months ago has a direct negative effect on the current arrivals, meaning that higher arrivals two months prior are associated with lower arrivals in the present month, and vice versa.\n\n### Composite plot of time series decomposition\n\nOne interesting function of **feasts** package is [gg_tsdisplay()](https://feasts.tidyverts.org/reference/gg_tsdisplay.html). It provides a composite plot by showing the original line graph on the top pane follow by the ACF on the left and seasonal plot on the right.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntsibble_longer %>%\n  filter(`Country` == \"Vietnam\") %>%\n  gg_tsdisplay(Arrivals)\n```\n\n::: {.cell-output-display}\n![](ICE_07_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n\n\n## Visual STL Diagnostics\n\nSTL is an acronym for “Seasonal and Trend decomposition using Loess”, where Loess is a method for estimating nonlinear relationships. It was developed by R. B. Cleveland, Cleveland, McRae, & Terpenning (1990), as a robust method of time series decomposition often used in economic and environmental analyses.\n\nThe STL method uses locally fitted regression models to decompose a time series into trend, seasonal, and remainder components by performing smoothing on the time series using LOESS in two loops:\n\n(1) The inner loop iterates between seasonal and trend smoothing\n(2) The outer loop minimizes the effect of outliers\n\nDuring the inner loop, the seasonal component is calculated first and removed to calculate the trend component. The remainder is calculated by subtracting the seasonal and trend components from the time series.\n\nThe benefits of using STL are:\n\n-   STL will handle any type of seasonality, not only monthly and quarterly data.\n-   The seasonal component is allowed to change over time, and the rate of change can be controlled by the user.\n-   The smoothness of the trend-cycle can also be controlled by the user.\n-   It can be robust to outliers (i.e., the user can specify a robust decomposition), so that occasional unusual observations will not affect the estimates of the trend-cycle and seasonal components. They will, however, affect the remainder component.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntsibble_longer %>%\n  filter(`Country` == \"Vietnam\") %>%\n  model(stl = STL(Arrivals)) %>%\n  components() %>%\n  autoplot()\n```\n\n::: {.cell-output-display}\n![](ICE_07_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n\n\nThe grey bars to the left of each panel show the relative scales of the components. Each grey bar represents the same length but because the plots are on different scales, the bars vary in size. The large grey bar in the bottom panel shows that the variation in the remainder component is smallest compared to the variation in the data. If we shrank the bottom three panels until their bars became the same size as that in the data panel, then all the panels would be on the same scale.\n\nFrom the above, as trend is an increasing linear line, season_year looks like a series with cycles, and the remainder (residual) looks like white noise, we conclude that ARIMA models would be a good fit for the data.\n\n### Classical Decomposition with feasts\n\nHere, we use `classical_decomposition()` of **feasts** package to decompose a time series into seasonal, trend and irregular components using moving averages. THe function is able to deal with both additive or multiplicative seasonal components.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntsibble_longer %>%\n  filter(`Country` == \"Vietnam\") %>%\n  model(\n    classical_decomposition(\n      Arrivals, type = \"additive\")) %>%\n  components() %>%\n  autoplot()\n```\n\n::: {.cell-output-display}\n![](ICE_07_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n\n\n## Visual Forecasting\n\nIn this section, we will use two R packages belonging to tidyverts family:\n\n-   [**fable**](https://lubridate.tidyverse.org/) provides a collection of commonly used univariate and multivariate time series forecasting models including exponential smoothing via state space models and automatic ARIMA modelling. It is a tidy version of the popular [**forecast**](https://cran.r-project.org/web/packages/forecast/forecast.pdf) package and a member of [**tidyverts**](https://tidyverts.org/)\n-   [**fabletools**](https://fabletools.tidyverts.org/) provides tools for building modelling packages, with a focus on time series forecasting. This package allows package developers to extend fable with additional models, without needing to depend on the models supported by fable.\n\n### Time Series Data Wrangling\n\nA good practice in forecasting is to split the original data set into a training and a hold-out data sets. The first part is called the *estimate sample* (also known as training data). It will be used to estimate the starting values and the smoothing parameters. This sample typically contains 75-80 percent of the observation, although the forecaster may choose to use a smaller percentage for longer series.\n\nThe second part of the time series is called the *hold-out sample*. It is used to check the forecasting performance. No matter how many parameters are estimated with the estimation sample, each method under consideration can be evaluated with the use of the “new” observation contained in the hold-out sample.\n\n![](images/image6.jpg)\n\nIn this example we will use the last 12 months for hold-out and the rest for training.\n\nFirst, an extra column called *Type* indicating \"training\" or \"hold-out\" will be created by using `mutate()` of **dplyr** package, to be used later.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvietnam_ts <- tsibble_longer %>%\n  filter(Country == \"Vietnam\") %>% \n  mutate(Type = if_else(\n    `Month-Year` >= \"2019-01-01\", \n    \"Hold-out\", \"Training\"))\n```\n:::\n\n\n\nThen, the training data set is extracted from the original data set by using `filter()` of **dplyr** package.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvietnam_train <- vietnam_ts %>%\n  filter(`Month-Year` < \"2019-01-01\")\n```\n:::\n\n\n\n### EDA: Time Series Data\n\nWe do the EDA as part of the process\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvietnam_train %>%\n  model(stl = STL(Arrivals)) %>%\n  components() %>%\n  autoplot()\n```\n\n::: {.cell-output-display}\n![](ICE_07_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n:::\n\n\n\n### Fitting forecasting models\n\n#### Fitting Exponential Smoothing State Space (ETS) Models: fable methods\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nETS(y ~ error(c(\"A\", \"M\")) \n    + trend(c(\"N\", \"A\", \"Ad\")) \n    + season(c(\"N\", \"A\", \"M\")))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n<ETS model definition>\n```\n\n\n:::\n:::\n\n\n#### Fitting a simple exponential smoothing (SES) model\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit_ses <- vietnam_train %>%\n  model(ETS(Arrivals ~ error(\"A\") \n            + trend(\"N\") \n            + season(\"N\")))\nfit_ses\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A mable: 1 x 2\n# Key:     Country [1]\n  Country `ETS(Arrivals ~ error(\"A\") + trend(\"N\") + season(\"N\"))`\n  <chr>                                                   <model>\n1 Vietnam                                            <ETS(A,N,N)>\n```\n\n\n:::\n:::\n\n\nNotice that `model()` of fable package is used to estimate the ETS model on a particular dataset, and returns a mable (model table) object.\n\nA mable contains a row for each time series (uniquely identified by the key variables), and a column for each model specification. A model is contained within the cells of each model column.\n\n#### Examine Model Assumptions\n\nNext, we use `gg_tsresiduals()` of **feasts** package to check the model assumptions with residuals plots.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngg_tsresiduals(fit_ses)\n```\n\n::: {.cell-output-display}\n![](ICE_07_files/figure-html/unnamed-chunk-27-1.png){width=672}\n:::\n:::\n\n\n\n#### Model Details\n\n[report()](https://fabletools.tidyverts.org/reference/report.html) of fabletools is be used to reveal the model details.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit_ses %>%\n  report()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSeries: Arrivals \nModel: ETS(A,N,N) \n  Smoothing parameters:\n    alpha = 0.9998995 \n\n  Initial states:\n     l[0]\n 10312.99\n\n  sigma^2:  27939164\n\n     AIC     AICc      BIC \n2911.726 2911.913 2920.374 \n```\n\n\n:::\n:::\n\n\n#### Fitting ETS Methods with Trend: Holt’s Linear Trend methods\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvietnam_H <- vietnam_train %>%\n  model(`Holt's method` = \n          ETS(Arrivals ~ error(\"A\") +\n                trend(\"A\") + \n                season(\"N\")))\nvietnam_H %>% report()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSeries: Arrivals \nModel: ETS(A,A,N) \n  Smoothing parameters:\n    alpha = 0.9998995 \n    beta  = 0.0001004625 \n\n  Initial states:\n     l[0]     b[0]\n 13673.29 525.8859\n\n  sigma^2:  28584805\n\n     AIC     AICc      BIC \n2916.695 2917.171 2931.109 \n```\n\n\n:::\n:::\n\n\n#### Fitting ETS Methods with Trend: Damped Trend methods\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvietnam_HAd <- vietnam_train %>%\n  model(`Holt's method` = \n          ETS(Arrivals ~ error(\"A\") +\n                trend(\"Ad\") + \n                season(\"N\")))\nvietnam_HAd %>% report()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSeries: Arrivals \nModel: ETS(A,Ad,N) \n  Smoothing parameters:\n    alpha = 0.9998999 \n    beta  = 0.0001098602 \n    phi   = 0.9784562 \n\n  Initial states:\n     l[0]   b[0]\n 13257.28 523.54\n\n  sigma^2:  28641536\n\n     AIC     AICc      BIC \n2917.921 2918.593 2935.218 \n```\n\n\n:::\n:::\n\n\n#### Checking Results\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngg_tsresiduals(vietnam_H)\n```\n\n::: {.cell-output-display}\n![](ICE_07_files/figure-html/unnamed-chunk-31-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ngg_tsresiduals(vietnam_HAd)\n```\n\n::: {.cell-output-display}\n![](ICE_07_files/figure-html/unnamed-chunk-32-1.png){width=672}\n:::\n:::\n\n\n\n#### Fitting ETS Methods with Season: Holt-Winters\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nVietnam_WH <- vietnam_train %>%\n  model(\n    Additive = ETS(Arrivals ~ error(\"A\") \n                   + trend(\"A\") \n                   + season(\"A\")),\n    Multiplicative = ETS(Arrivals ~ error(\"M\") \n                         + trend(\"A\") \n                         + season(\"M\"))\n    )\n\nVietnam_WH %>% report()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 10\n  Country .model          sigma2 log_lik   AIC  AICc   BIC    MSE   AMSE     MAE\n  <chr>   <chr>            <dbl>   <dbl> <dbl> <dbl> <dbl>  <dbl>  <dbl>   <dbl>\n1 Vietnam Additive       5.33e+6  -1336. 2706. 2711. 2755. 4.68e6 8.56e6 1.72e+3\n2 Vietnam Multiplicative 4.55e-3  -1300. 2635. 2640. 2684. 3.05e6 3.42e6 5.20e-2\n```\n\n\n:::\n:::\n\n\n#### Fitting multiple ETS Models\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit_ETS <- vietnam_train %>%\n  model(`SES` = ETS(Arrivals ~ error(\"A\") + \n                      trend(\"N\") + \n                      season(\"N\")),\n        `Holt`= ETS(Arrivals ~ error(\"A\") +\n                      trend(\"A\") +\n                      season(\"N\")),\n        `damped Holt` = \n          ETS(Arrivals ~ error(\"A\") +\n                trend(\"Ad\") + \n                season(\"N\")),\n        `WH_A` = ETS(\n          Arrivals ~ error(\"A\") + \n            trend(\"A\") + \n            season(\"A\")),\n        `WH_M` = ETS(Arrivals ~ error(\"M\") \n                         + trend(\"A\") \n                         + season(\"M\"))\n  )\n```\n:::\n\n\n\n### The model coefficient\n\n[tidy()](https://fabletools.tidyverts.org/reference/tidy.html) of fabletools is be used to extract model coefficients from a mable.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit_ETS %>%\n  tidy()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 45 × 4\n   Country .model      term      estimate\n   <chr>   <chr>       <chr>        <dbl>\n 1 Vietnam SES         alpha     1.00    \n 2 Vietnam SES         l[0]  10313.      \n 3 Vietnam Holt        alpha     1.00    \n 4 Vietnam Holt        beta      0.000100\n 5 Vietnam Holt        l[0]  13673.      \n 6 Vietnam Holt        b[0]    526.      \n 7 Vietnam damped Holt alpha     1.00    \n 8 Vietnam damped Holt beta      0.000110\n 9 Vietnam damped Holt phi       0.978   \n10 Vietnam damped Holt l[0]  13257.      \n# ℹ 35 more rows\n```\n\n\n:::\n:::\n\n\n### Model Comparison\nWe use report() of **fabletool**\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit_ETS %>% \n  report()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 5 × 10\n  Country .model       sigma2 log_lik   AIC  AICc   BIC       MSE   AMSE     MAE\n  <chr>   <chr>         <dbl>   <dbl> <dbl> <dbl> <dbl>     <dbl>  <dbl>   <dbl>\n1 Vietnam SES         2.79e+7  -1453. 2912. 2912. 2920. 27515844. 5.99e7 3.91e+3\n2 Vietnam Holt        2.86e+7  -1453. 2917. 2917. 2931. 27718599. 6.03e7 3.92e+3\n3 Vietnam damped Holt 2.86e+7  -1453. 2918. 2919. 2935. 27556629. 5.97e7 3.92e+3\n4 Vietnam WH_A        5.33e+6  -1336. 2706. 2711. 2755.  4684271. 8.56e6 1.72e+3\n5 Vietnam WH_M        4.55e-3  -1300. 2635. 2640. 2684.  3046059. 3.42e6 5.20e-2\n```\n\n\n:::\n:::\n\n\n### Forecasting future values\n\nWe use `forecast()` of **fable** to forecast ahead by 12 months.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit_ETS %>%\n  forecast(h = \"12 months\") %>%\n  autoplot(vietnam_ts, \n           level = NULL)\n```\n\n::: {.cell-output-display}\n![](ICE_07_files/figure-html/unnamed-chunk-37-1.png){width=672}\n:::\n:::\n\n\n\nThis forms a visual complement to the `report()` function above.\n\n### Fitting ETS Automatically\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit_autoETS <- vietnam_train %>%\n  model(ETS(Arrivals))\nfit_autoETS %>% report()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSeries: Arrivals \nModel: ETS(M,A,M) \n  Smoothing parameters:\n    alpha = 0.1613503 \n    beta  = 0.0001021811 \n    gamma = 0.0001030996 \n\n  Initial states:\n     l[0]     b[0]      s[0]     s[-1]     s[-2]     s[-3]    s[-4]    s[-5]\n 15001.12 212.3552 0.9167302 0.8311728 0.8739287 0.8690543 1.104668 1.485584\n    s[-6]     s[-7]    s[-8]     s[-9]    s[-10]    s[-11]\n 1.311207 0.9917759 1.014187 0.8973028 0.8816768 0.8227129\n\n  sigma^2:  0.0046\n\n     AIC     AICc      BIC \n2634.751 2640.119 2683.759 \n```\n\n\n:::\n:::\n\n\n### Check model assumptions\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngg_tsresiduals(fit_autoETS)\n```\n\n::: {.cell-output-display}\n![](ICE_07_files/figure-html/unnamed-chunk-39-1.png){width=672}\n:::\n:::\n\n\nWe expect the residuals to be a white noise process. From the ACF graph, we can see that one value appears to just be significant. This is normal as it level of significance is 5% i.e. out of the 21 lags we observe, we can expect 1 to be on the side of significant.\n\nThe normally distributed nature of the residuals confirms that the model is right.\n\n### Forecast future values\n\n`forecast()` of **fable** package is used to forecast future values. Then, `autoplot()` of **feasts** package is used to see the training data along with the forecast values.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit_autoETS %>%\n  forecast(h = \"12 months\") %>%\n  autoplot(vietnam_train)\n```\n\n::: {.cell-output-display}\n![](ICE_07_files/figure-html/unnamed-chunk-40-1.png){width=672}\n:::\n:::\n\n\n\nIt is quite difficult to see the overlapping uncertainty levels, so only plot data from 2017 onwards by filtering the dates.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvietnam_train_zoom <- vietnam_train %>%\n  filter(Month >= as.Date(\"2017-01-01\"))\n\nfit_autoETS %>%\n  forecast(h = \"12 months\") %>%\n  autoplot(vietnam_train_zoom)\n```\n\n::: {.cell-output-display}\n![](ICE_07_files/figure-html/unnamed-chunk-41-1.png){width=672}\n:::\n:::\n\n\n\n### Visualising AutoETS model with ggplot2\n\nWe are interested to understand the relationship between training data, fitted regression, and forecasted values versus the hold-out data, so we plot it all.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfc_autoETS <- fit_autoETS %>%\n  forecast(h = \"12 months\")\n\nvietnam_ts %>%\n  ggplot(aes(x=`Month`, \n             y=Arrivals)) +\n  autolayer(fc_autoETS, \n            alpha = 0.6) +\n  geom_line(aes(\n    color = Type), \n    alpha = 0.8) + \n  geom_line(aes(\n    y = .mean, \n    colour = \"Forecast\"), \n    data = fc_autoETS) +\n  geom_line(aes(\n    y = .fitted, \n    colour = \"Fitted\"), \n    data = augment(fit_autoETS))\n```\n\n::: {.cell-output-display}\n![](ICE_07_files/figure-html/unnamed-chunk-42-1.png){width=672}\n:::\n:::\n\n\nWe have the same issue as before, with difficulty viewing the uncertainty levels, so again we filter the dates to zoom in.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvietnam_ts_zoom <- vietnam_ts %>%\n  filter(Month >= as.Date(\"2017-01-01\"))\n\nfc_autoETS <- fit_autoETS %>%\n  forecast(h = \"12 months\")\n\nfitted_values_zoom <- augment(fit_autoETS) %>%\n  filter(Month >= as.Date(\"2017-01-01\"))\n\nvietnam_ts_zoom %>%\n  ggplot(aes(x=`Month`, \n             y=Arrivals)) +\n  autolayer(fc_autoETS, \n            alpha = 0.6) +\n  geom_line(aes(\n    color = Type), \n    alpha = 0.8) + \n  geom_line(aes(\n    y = .mean, \n    colour = \"Forecast\"), \n    data = fc_autoETS) +\n  geom_line(aes(\n    y = .fitted, \n    colour = \"Fitted\"), \n    data = fitted_values_zoom)\n```\n\n::: {.cell-output-display}\n![](ICE_07_files/figure-html/unnamed-chunk-43-1.png){width=672}\n:::\n:::\n\n\n\n## AutoRegressive Integrated Moving Average(ARIMA) Methods for Time Series Forecasting: tidyverts' fable methods\n\n### Visualising Autocorrelations: feasts methods\n\n[**feasts**] package provides a very handy function for visualising the ACF and PACF of a time series called [gg_tsdisplay()](https://feasts.tidyverts.org/reference/gg_tsdisplay.html).\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvietnam_train %>%\n  gg_tsdisplay(plot_type='partial')\n```\n\n::: {.cell-output-display}\n![](ICE_07_files/figure-html/unnamed-chunk-44-1.png){width=672}\n:::\n:::\n\n\n\nWe can analyse the ACF to a greater depth.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntsibble_longer %>%\n  filter(`Country` == \"Vietnam\") %>%\n  ACF(Arrivals) %>% \n  autoplot()\n```\n\n::: {.cell-output-display}\n![](ICE_07_files/figure-html/unnamed-chunk-45-1.png){width=672}\n:::\n:::\n\n\n\nOr for a different country.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntsibble_longer %>%\n  filter(`Country` == \"United Kingdom\") %>%\n  ACF(Arrivals) %>% \n  autoplot()\n```\n\n::: {.cell-output-display}\n![](ICE_07_files/figure-html/unnamed-chunk-46-1.png){width=672}\n:::\n:::\n\n\n\nBy comparing both ACF plots, it is clear that visitor arrivals from United Kingdom were very seasonal and lacking in trend as compared to visitor arrivals from Vietnam.\n\n### Differencing: fable methods\n\n#### Trend differencing\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntsibble_longer %>%\n  filter(Country == \"Vietnam\") %>%\n  gg_tsdisplay(difference(\n    Arrivals,\n    lag = 1), \n    plot_type='partial')\n```\n\n::: {.cell-output-display}\n![](ICE_07_files/figure-html/unnamed-chunk-47-1.png){width=672}\n:::\n:::\n\n\n#### Seasonal differencing\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntsibble_longer %>%\n  filter(Country == \"Vietnam\") %>%\n  gg_tsdisplay(difference(\n    Arrivals,\n    difference = 12), \n    plot_type='partial')\n```\n\n::: {.cell-output-display}\n![](ICE_07_files/figure-html/unnamed-chunk-48-1.png){width=672}\n:::\n:::\n\n\nAn AR(1) model should have an ACF which decays exponentially, while the PACF is such that the first lag is significant, and subsequent lags are not. A MA(1) model is inverted in the above ACF and PACF features.\n\n### Fitting ARIMA models manually: fable methods\n\nWe don't see any of the ACF nor PACF features to have a good guess of the ARIMA parameters, so we will try to fit 2 random models:\n\n(1)  Autoregressive of lag 2, with no differencing (integrative) and no moving average shocks. This is ARIMA(2,0,0)\n(2)  The same as above, but added with seasonal autoregressive lags of 2 and seasonal differencing of 1, with no seasonal MA processes. This is ARIMA(2,0,0)(2,1,0).\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit_arima <- vietnam_train %>%\n  model(\n    arima200 = ARIMA(Arrivals ~ pdq(2,0,0)),\n    sarima210 = ARIMA(Arrivals ~ pdq(2,0,0) + \n                        PDQ(2,1,0))\n    )\nreport(fit_arima)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 9\n  Country .model      sigma2 log_lik   AIC  AICc   BIC ar_roots   ma_roots \n  <chr>   <chr>        <dbl>   <dbl> <dbl> <dbl> <dbl> <list>     <list>   \n1 Vietnam arima200  4173906.  -1085. 2181. 2182. 2198. <cpl [26]> <cpl [0]>\n2 Vietnam sarima210 4173906.  -1085. 2181. 2182. 2198. <cpl [26]> <cpl [0]>\n```\n\n\n:::\n:::\n\n\n\nThe `report()` function provides us with details of the fittedmodel.\n\n### Fitting ARIMA models automatically: fable methods\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit_autoARIMA <- vietnam_train %>%\n  model(ARIMA(Arrivals))\nreport(fit_autoARIMA)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSeries: Arrivals \nModel: ARIMA(2,0,0)(2,1,0)[12] w/ drift \n\nCoefficients:\n         ar1     ar2     sar1     sar2   constant\n      0.4748  0.1892  -0.5723  -0.1578  1443.2068\ns.e.  0.0924  0.0903   0.0989   0.1032   188.9468\n\nsigma^2 estimated as 4173906:  log likelihood=-1084.6\nAIC=2181.19   AICc=2181.94   BIC=2197.92\n```\n\n\n:::\n:::\n\n\n\n### Model Comparisons\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbind_rows(\n    fit_autoARIMA %>% accuracy(),\n    fit_autoETS %>% accuracy(),\n    fit_autoARIMA %>% \n      forecast(h = 12) %>% \n      accuracy(vietnam_ts),\n    fit_autoETS %>% \n      forecast(h = 12) %>% \n      accuracy(vietnam_ts)) %>%\n  select(-ME, -MPE, -ACF1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 × 8\n  Country .model          .type     RMSE   MAE  MAPE  MASE RMSSE\n  <chr>   <chr>           <chr>    <dbl> <dbl> <dbl> <dbl> <dbl>\n1 Vietnam ARIMA(Arrivals) Training 1907. 1458.  5.37 0.491 0.517\n2 Vietnam ETS(Arrivals)   Training 1745. 1386.  5.29 0.467 0.473\n3 Vietnam ARIMA(Arrivals) Test     2647. 2136.  5.17 0.720 0.717\n4 Vietnam ETS(Arrivals)   Test     3163. 2636.  6.64 0.889 0.857\n```\n\n\n:::\n:::\n\n\n\n### Forecasting Multiple Time Series\nHere we will perform time series forecasting on multiple time series at one go. For the purpose of the exercise, visitor arrivals from five selected ASEAN countries will be used.\n\nFirst, `filter()` is used to extract the selected countries’ data.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nASEAN <- tsibble_longer %>%\n  filter(Country == \"Vietnam\" |\n         Country == \"Malaysia\" |\n         Country == \"Indonesia\" |\n         Country == \"Thailand\" |\n         Country == \"Philippines\")\n```\n:::\n\n\n\nNext, `mutate()` is used to create a new field named *Type* to split the data into Training and Hold-out samples. Lastly, `filter()` is used to extract the training data set and save it as a tsibble object called ASEAN_train.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nASEAN_train <- ASEAN %>%\n  mutate(Type = if_else(\n    `Month-Year` >= \"2019-01-01\", \n    \"Hold-out\", \"Training\")) %>%\n  filter(Type == \"Training\")\n```\n:::\n\n\n\n### Fitting Mulltiple Time Series\n\nWe autofit both ETS and ARIMA models using `model()`.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nASEAN_fit <- ASEAN_train %>%\n  model(\n    ets = ETS(Arrivals),\n    arima = ARIMA(Arrivals)\n  )\n```\n:::\n\n\n\n### Examining Models\n\nThe `glance()` function of **fabletools** provides a one-row summary of each model, and commonly includes descriptions of the model’s fit such as the residual variance and information criteria.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nASEAN_fit %>%\n  glance()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 10 × 12\n   Country     .model  sigma2 log_lik   AIC  AICc   BIC      MSE    AMSE     MAE\n   <chr>       <chr>    <dbl>   <dbl> <dbl> <dbl> <dbl>    <dbl>   <dbl>   <dbl>\n 1 Indonesia   ets    1.02e-2  -1561. 3156. 3161. 3205.   1.74e8  1.80e8  0.0732\n 2 Indonesia   arima  1.48e+8  -1290. 2589. 2590. 2603.  NA      NA      NA     \n 3 Malaysia    ets    4.67e-3  -1430. 2894. 2899. 2943.   2.04e7  2.00e7  0.0506\n 4 Malaysia    arima  2.62e+7  -1185. 2378. 2379. 2390.  NA      NA      NA     \n 5 Philippines ets    3.56e-3  -1343. 2722. 2728. 2774.   5.28e6  7.58e6  0.0461\n 6 Philippines arima  8.04e+6  -1122. 2260. 2262. 2283.  NA      NA      NA     \n 7 Thailand    ets    6.63e-3  -1343. 2722. 2728. 2774.   5.40e6  6.33e6  0.0584\n 8 Thailand    arima  8.51e+6  -1127. 2269. 2270. 2288.  NA      NA      NA     \n 9 Vietnam     ets    4.55e-3  -1300. 2635. 2640. 2684.   3.05e6  3.42e6  0.0520\n10 Vietnam     arima  4.17e+6  -1085. 2181. 2182. 2198.  NA      NA      NA     \n# ℹ 2 more variables: ar_roots <list>, ma_roots <list>\n```\n\n\n:::\n:::\n\n\nBe wary though, as information criteria (AIC, AICc, BIC) are only comparable between the same model class and only if those models share the same response (after transformations and differencing).\n\n### Extracintg fitted and residual values\n\nThe fitted values and residuals from a model can obtained using the  `fitted()` and `residuals()` functions respectively. A more comprehensive picture is provided by the `augment()` function, which provides the original data along with both fitted values and their residuals.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nASEAN_fit %>%\n  augment()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tsibble: 1,320 x 7 [1M]\n# Key:       Country, .model [10]\n   Country   .model    Month Arrivals .fitted  .resid  .innov\n   <chr>     <chr>     <mth>    <dbl>   <dbl>   <dbl>   <dbl>\n 1 Indonesia ets    2008 Jan    62683  56534.   6149.  0.109 \n 2 Indonesia ets    2008 Feb    47834  46417.   1417.  0.0305\n 3 Indonesia ets    2008 Mar    64688  62660.   2028.  0.0324\n 4 Indonesia ets    2008 Apr    58074  61045.  -2971. -0.0487\n 5 Indonesia ets    2008 May    57089  62280.  -5191. -0.0833\n 6 Indonesia ets    2008 Jun    70118  75791.  -5673. -0.0749\n 7 Indonesia ets    2008 Jul    73805  78691.  -4886. -0.0621\n 8 Indonesia ets    2008 Aug    58015  61910.  -3895. -0.0629\n 9 Indonesia ets    2008 Sep    63730  74518. -10788. -0.145 \n10 Indonesia ets    2008 Oct    71206  67869.   3337.  0.0492\n# ℹ 1,310 more rows\n```\n\n\n:::\n:::\n\n\n### Comparing Fit Models\n\n`accuracy()` is used to compare the performances of the models.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nASEAN_fit %>%\n  accuracy() %>%\n  arrange(Country)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 10 × 11\n   Country   .model .type      ME   RMSE   MAE    MPE  MAPE  MASE RMSSE     ACF1\n   <chr>     <chr>  <chr>   <dbl>  <dbl> <dbl>  <dbl> <dbl> <dbl> <dbl>    <dbl>\n 1 Indonesia ets    Trai… -1.81e3 13187. 9665. -1.83   7.57 0.556 0.619 -0.236  \n 2 Indonesia arima  Trai… -9.54e1 11351. 8382. -0.136  6.38 0.482 0.533 -0.00802\n 3 Malaysia  ets    Trai… -6.78e2  4515. 3538. -1.25   5.15 0.529 0.527 -0.288  \n 4 Malaysia  arima  Trai… -2.33e1  4801. 3684. -0.109  5.20 0.551 0.561 -0.00933\n 5 Philippi… ets    Trai… -2.35e0  2298. 1897. -0.334  4.64 0.464 0.408  0.0400 \n 6 Philippi… arima  Trai…  9.53e0  2624. 1934. -0.269  4.60 0.473 0.466  0.00717\n 7 Thailand  ets    Trai…  1.97e1  2323. 1773. -0.511  5.89 0.489 0.485 -0.0812 \n 8 Thailand  arima  Trai…  5.88e1  2710. 1932. -0.562  6.16 0.532 0.565 -0.0112 \n 9 Vietnam   ets    Trai… -3.52e1  1745. 1386. -0.728  5.29 0.467 0.473  0.279  \n10 Vietnam   arima  Trai…  1.95e0  1907. 1458. -0.671  5.37 0.491 0.517  0.0136 \n```\n\n\n:::\n:::\n\n\n### Forecast Future Values\n\nForecasts from these models can be produced directly as our specified models do not require any additional data.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nASEAN_fc <- ASEAN_fit %>%\n  forecast(h = \"12 months\")\n```\n:::\n\n\n\n### Visualising the forecasted values\n\n`autoplot()` of **feasts** package is used to plot the raw and fitted values.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nASEAN_fc %>%\n  autoplot(ASEAN)\n```\n\n::: {.cell-output-display}\n![](ICE_07_files/figure-html/unnamed-chunk-59-1.png){width=672}\n:::\n:::\n\n\n\nThere is varied performance by both ETS and ARIMA models across different countries data. A good compromise would be to combine predictions from both models for better forecasts.\n\n## Reference\n\nRob J Hyndman and George Athanasopoulos (2022) [**Forecasting: Principles and Practice (3rd ed)**](https://otexts.com/fpp3/), online version.\n",
    "supporting": [
      "ICE_07_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}